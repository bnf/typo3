/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
<<<<<<< HEAD
var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define(["require","exports","jquery","TYPO3/CMS/Core/Ajax/AjaxRequest","TYPO3/CMS/Backend/ModuleMenu","TYPO3/CMS/Backend/Viewport","TYPO3/CMS/Core/Event/RegularEvent","TYPO3/CMS/Backend/Storage/ModuleStateStorage","TYPO3/CMS/Backend/Icons"],(function(e,t,o,r,a,n,s,c,l){"use strict";var i,d;o=__importDefault(o),function(e){e.containerSelector="#typo3-cms-workspaces-backend-toolbaritems-workspaceselectortoolbaritem",e.activeMenuItemLinkSelector=".dropdown-menu .selected",e.menuItemIconHolderSelector=".dropdown-table-icon",e.menuItemSelector=".t3js-workspace-item",e.menuItemLinkSelector=".t3js-workspaces-switchlink",e.toolbarItemSelector=".dropdown-toggle",e.workspaceModuleLinkSelector=".t3js-workspaces-modulelink"}(i||(i={})),function(e){e.workspaceBodyClass="typo3-in-workspace",e.workspacesTitleInToolbarClass="toolbar-item-name"}(d||(d={}));class p{static refreshPageTree(){document.dispatchEvent(new CustomEvent("typo3:pagetree:refresh"))}static getWorkspaceState(){const e=document.querySelector([i.containerSelector,i.activeMenuItemLinkSelector,i.menuItemLinkSelector].join(" "));if(null===e)return null;const t=parseInt(e.dataset.workspaceid||"0",10);return{id:t,title:e.innerText.trim(),inWorkspace:0!==t}}static updateTopBar(e){o.default("."+d.workspacesTitleInToolbarClass,i.containerSelector).remove(),l.getIcon("empty-empty",l.sizes.small).then(e=>{o.default(i.containerSelector+" "+i.menuItemSelector).each((t,o)=>{const r=o.querySelector(i.menuItemIconHolderSelector);r&&(r.innerHTML=e)})}),e.inWorkspace&&e.title&&o.default(i.toolbarItemSelector,i.containerSelector).append(o.default("<span>",{class:d.workspacesTitleInToolbarClass}).text(e.title));const t=document.querySelector([i.containerSelector,i.activeMenuItemLinkSelector,i.menuItemIconHolderSelector].join(" "));null!==t&&l.getIcon("actions-check",l.sizes.small).then(e=>{t.innerHTML=e})}static updateBackendContext(e=null){null===e&&null===(e=p.getWorkspaceState())||(e.inWorkspace?(o.default("body").addClass(d.workspaceBodyClass),e.title||(e.title=TYPO3.lang["Workspaces.workspaceTitle"])):o.default("body").removeClass(d.workspaceBodyClass),p.updateTopBar(e))}constructor(){n.Topbar.Toolbar.registerEvent(()=>{this.initializeEvents(),p.updateBackendContext()}),new s("typo3:datahandler:process",e=>{const t=e.detail.payload;"sys_workspace"===t.table&&"delete"===t.action&&!1===t.hasErrors&&n.Topbar.refresh()}).bindTo(document)}performWorkspaceSwitch(e,t){var r,a;o.default(i.activeMenuItemLinkSelector,i.containerSelector).removeClass("selected"),null===(a=null===(r=o.default(i.menuItemLinkSelector+"[data-workspaceid="+e+"]",i.containerSelector))||void 0===r?void 0:r.closest(i.menuItemSelector))||void 0===a||a.addClass("selected"),p.updateBackendContext({id:e,title:t,inWorkspace:0!==e})}initializeEvents(){o.default(i.containerSelector).on("click",i.workspaceModuleLinkSelector,e=>{e.preventDefault(),a.App.showModule(e.currentTarget.dataset.module)}),o.default(i.containerSelector).on("click",i.menuItemLinkSelector,e=>{e.preventDefault(),this.switchWorkspace(parseInt(e.currentTarget.dataset.workspaceid,10))})}switchWorkspace(e){new r(TYPO3.settings.ajaxUrls.workspace_switch).post({workspaceId:e,pageId:c.ModuleStateStorage.current("web").identifier}).then(async t=>{const o=await t.resolve();o.workspaceId||(o.workspaceId=0),this.performWorkspaceSwitch(o.workspaceId,o.title||"");const r=a.App.getCurrentModule();if(o.pageId){let e=TYPO3.Backend.ContentContainer.getUrl();e+=(e.includes("?")?"&":"?")+"id="+o.pageId,n.ContentContainer.setUrl(e)}else r.startsWith("web_")?"web_WorkspacesWorkspaces"===r?a.App.showModule(r,"workspace="+e):a.App.reloadFrames():o.pageModule&&a.App.showModule(o.pageModule);p.refreshPageTree(),a.App.refreshMenu()})}}const u=new p;return TYPO3.WorkspacesMenu=u,u}));
=======
define(["jquery","TYPO3/CMS/Core/Ajax/AjaxRequest","TYPO3/CMS/Backend/ModuleMenu","TYPO3/CMS/Backend/Viewport","TYPO3/CMS/Core/Event/RegularEvent","TYPO3/CMS/Backend/Storage/ModuleStateStorage"],(function(e,t,o,a,r,s){"use strict";var c,n;!function(e){e.containerSelector="#typo3-cms-workspaces-backend-toolbaritems-workspaceselectortoolbaritem",e.activeMenuItemLinkSelector=".dropdown-menu .selected",e.menuItemSelector=".t3js-workspace-item",e.menuItemLinkSelector=".t3js-workspaces-switchlink",e.toolbarItemSelector=".dropdown-toggle",e.workspaceModuleLinkSelector=".t3js-workspaces-modulelink"}(c||(c={})),function(e){e.workspaceBodyClass="typo3-in-workspace",e.workspacesTitleInToolbarClass="toolbar-item-name"}(n||(n={}));class l{static refreshPageTree(){document.dispatchEvent(new CustomEvent("typo3:pagetree:refresh"))}static updateWorkspaceState(){const e=document.querySelector(c.containerSelector+" .t3js-workspace-item.selected .t3js-workspaces-switchlink");if(null!==e){const t=parseInt(e.dataset.workspaceid,10),o=e.innerText.trim();top.TYPO3.configuration.inWorkspace=0!==t,top.TYPO3.Backend.workspaceTitle=top.TYPO3.configuration.inWorkspace?o:""}}static updateTopBar(t){if(e("."+n.workspacesTitleInToolbarClass,c.containerSelector).remove(),t&&t.length){let o=e("<span>",{class:n.workspacesTitleInToolbarClass}).text(t);e(c.toolbarItemSelector,c.containerSelector).append(o)}}static updateBackendContext(){let t="";l.updateWorkspaceState(),TYPO3.configuration.inWorkspace?(e("body").addClass(n.workspaceBodyClass),t=top.TYPO3.Backend.workspaceTitle||TYPO3.lang["Workspaces.workspaceTitle"]):e("body").removeClass(n.workspaceBodyClass),l.updateTopBar(t)}constructor(){a.Topbar.Toolbar.registerEvent(()=>{this.initializeEvents(),l.updateBackendContext()}),new r("typo3:datahandler:process",e=>{const t=e.detail.payload;"sys_workspace"===t.table&&"delete"===t.action&&!1===t.hasErrors&&a.Topbar.refresh()}).bindTo(document)}performWorkspaceSwitch(t){e(c.activeMenuItemLinkSelector+" i",c.containerSelector).removeClass("fa fa-check").addClass("fa fa-empty-empty"),e(c.activeMenuItemLinkSelector,c.containerSelector).removeClass("selected");const o=e(c.menuItemLinkSelector+"[data-workspaceid="+t+"]",c.containerSelector).closest(c.menuItemSelector);o.find("i").removeClass("fa fa-empty-empty").addClass("fa fa-check"),o.addClass("selected"),l.updateBackendContext()}initializeEvents(){e(c.containerSelector).on("click",c.workspaceModuleLinkSelector,e=>{e.preventDefault(),o.App.showModule(e.currentTarget.dataset.module)}),e(c.containerSelector).on("click",c.menuItemLinkSelector,e=>{e.preventDefault(),this.switchWorkspace(parseInt(e.currentTarget.dataset.workspaceid,10))})}switchWorkspace(e){new t(TYPO3.settings.ajaxUrls.workspace_switch).post({workspaceId:e,pageId:s.ModuleStateStorage.current("web").identifier}).then(async t=>{const r=await t.resolve();if(r.workspaceId||(r.workspaceId=0),this.performWorkspaceSwitch(parseInt(r.workspaceId,10)),r.pageId){s.ModuleStateStorage.update("web",r.pageId,!0);let e=TYPO3.Backend.ContentContainer.getUrl();e+=(e.includes("?")?"&":"?")+"&id="+r.pageId,l.refreshPageTree(),a.ContentContainer.setUrl(e)}else top.currentModuleLoaded.startsWith("web_")?(l.refreshPageTree(),"web_WorkspacesWorkspaces"===top.currentModuleLoaded?o.App.showModule(top.currentModuleLoaded,"workspace="+e):o.App.reloadFrames()):TYPO3.configuration.pageModule&&o.App.showModule(TYPO3.configuration.pageModule);o.App.refreshMenu()})}}const i=new l;return TYPO3.WorkspacesMenu=i,i}));
>>>>>>> 8b6510d860 ([POC][WIP][TASK] TypeScript: Do only use ES6 exports, no pseudo imports)
