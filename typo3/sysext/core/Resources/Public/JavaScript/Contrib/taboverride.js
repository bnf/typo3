/*! taboverride v4.0.3 | https://github.com/wjbryant/taboverride
(c) 2015 Bill Bryant | http://opensource.org/licenses/mit */
!function(e){"use strict";"object"==typeof exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(window.tabOverride={})}((function(e){"use strict";var t,n,r,i=window.document,l="\t",o=9,c=9,a=[],s=["shiftKey"],f=!0,u=!1,d=i.createElement("textarea"),h={};function v(e,t){var n,r,i,l=["alt","ctrl","meta","shift"],o=e.length,c=!0;for(n=0;n<o;n+=1)if(!t[e[n]]){c=!1;break}if(c)for(n=0;n<l.length;n+=1){if(t[i=l[n]+"Key"])if(o){for(c=!1,r=0;r<o;r+=1)if(i===e[r]){c=!0;break}}else c=!1;if(!c)break}return c}function p(e,t){return e===o&&v(a,t)}function g(e,t){return e===c&&v(s,t)}function m(e,t){return function(n,r){var i,l="";if(arguments.length){if("number"==typeof n&&(e(n),t.length=0,r&&r.length))for(i=0;i<r.length;i+=1)t.push(r[i]+"Key");return this}for(i=0;i<t.length;i+=1)l+=t[i].slice(0,-3)+"+";return l+e()}}function y(e){var t,a,s,d,h,v,m,y,E,x,b,L,S,k,w,T,O,K,A=(e=e||event).currentTarget||e.srcElement,C=e.keyCode;if((!A.nodeName||"textarea"===A.nodeName.toLowerCase())&&(C===o||C===c||13===C&&f)){if(u=!1,s=A.value,y=A.scrollTop,"number"==typeof A.selectionStart)E=A.selectionStart,x=A.selectionEnd,b=s.slice(E,x);else{if(!i.selection)return;b=(d=i.selection.createRange()).text,(h=d.duplicate()).moveToElementText(A),h.setEndPoint("EndToEnd",d),E=(x=h.text.length)-b.length,r>1?(v=s.slice(0,E).split(n).length-1,m=b.split(n).length-1):v=m=0}if(C===o||C===c)if(a=(t=l).length,k=0,w=0,T=0,E!==x&&-1!==b.indexOf("\n"))if(L=0===E||"\n"===s.charAt(E-1)?E:s.lastIndexOf("\n",E-1)+1,x===s.length||"\n"===s.charAt(x)?S=x:"\n"===s.charAt(x-1)?S=x-1:-1===(S=s.indexOf("\n",x))&&(S=s.length),p(C,e))k=1,A.value=s.slice(0,L)+t+s.slice(L,S).replace(/\n/g,(function(){return k+=1,"\n"+t}))+s.slice(S),d?(d.collapse(),d.moveEnd("character",x+k*a-m-v),d.moveStart("character",E+a-v),d.select()):(A.selectionStart=E+a,A.selectionEnd=x+k*a,A.scrollTop=y);else{if(!g(C,e))return;0===s.slice(L).indexOf(t)&&(L===E?b=b.slice(a):T=a,w=a),A.value=s.slice(0,L)+s.slice(L+T,E)+b.replace(new RegExp("\n"+t,"g"),(function(){return k+=1,"\n"}))+s.slice(x),d?(d.collapse(),d.moveEnd("character",x-w-k*a-m-v),d.moveStart("character",E-T-v),d.select()):(A.selectionStart=E-T,A.selectionEnd=x-w-k*a)}else if(p(C,e))d?(d.text=t,d.select()):(A.value=s.slice(0,E)+t+s.slice(x),A.selectionEnd=A.selectionStart=E+a,A.scrollTop=y);else{if(!g(C,e))return;0===s.slice(E-a).indexOf(t)&&(A.value=s.slice(0,E-a)+s.slice(E),d?(d.move("character",E-a-v),d.select()):(A.selectionEnd=A.selectionStart=E-a,A.scrollTop=y))}else if(f){if(0===E||"\n"===s.charAt(E-1))return void(u=!0);if(L=s.lastIndexOf("\n",E-1)+1,-1===(S=s.indexOf("\n",E))&&(S=s.length),E<L+(K=(O=s.slice(L,S).match(/^[ \t]*/)[0]).length))return void(u=!0);d?(d.text="\n"+O,d.select()):(A.value=s.slice(0,E)+"\n"+O+s.slice(x),A.selectionEnd=A.selectionStart=E+r+K,A.scrollTop=y)}if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}function E(e){var t=(e=e||event).keyCode;if(p(t,e)||g(t,e)||13===t&&f&&!u){if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}function x(e,t){var n,r=h[e]||[],i=r.length;for(n=0;n<i;n+=1)r[n].apply(null,t)}function b(e){var t,n,r,l=e.length;function o(n){for(t=0;t<l;t+=1)n(e[t].type,e[t].handler)}return i.addEventListener?(n=function(e){o((function(t,n){e.removeEventListener(t,n,!1)}))},r=function(e){n(e),o((function(t,n){e.addEventListener(t,n,!1)}))}):i.attachEvent&&(n=function(e){o((function(t,n){e.detachEvent("on"+t,n)}))},r=function(e){n(e),o((function(t,n){e.attachEvent("on"+t,n)}))}),{add:r,remove:n}}function L(e){x("addListeners",[e]),t.add(e)}function S(e){x("removeListeners",[e]),t.remove(e)}t=b([{type:"keydown",handler:y},{type:"keypress",handler:E}]),d.value="\n",n=d.value,r=n.length,d=null,e.utils={executeExtensions:x,isValidModifierKeyCombo:v,createListeners:b,addListeners:L,removeListeners:S},e.handlers={keydown:y,keypress:E},e.addExtension=function(e,t){return e&&"string"==typeof e&&"function"==typeof t&&(h[e]||(h[e]=[]),h[e].push(t)),this},e.set=function(e,t){var n,r,i,l,o,c,a;if(e)for(n=arguments.length<2||t,"number"!=typeof(i=(r=e).length)&&(r=[r],i=1),n?(l=L,o="true"):(l=S,o=""),c=0;c<i;c+=1)(a=r[c])&&a.nodeName&&"textarea"===a.nodeName.toLowerCase()&&(x("set",[a,n]),a.setAttribute("data-taboverride-enabled",o),l(a));return this},e.tabSize=function(e){var t;if(arguments.length){if(e&&"number"==typeof e&&e>0)for(l="",t=0;t<e;t+=1)l+=" ";else l="\t";return this}return"\t"===l?0:l.length},e.autoIndent=function(e){return arguments.length?(f=!!e,this):f},e.tabKey=m((function(e){if(!arguments.length)return o;o=e}),a),e.untabKey=m((function(e){if(!arguments.length)return c;c=e}),s)}));